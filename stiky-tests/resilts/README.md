Для проведения нагрузки использовалась библиотека k6 (https://k6.io/), т.к. её можно быстро настроить и писать тесты на привычном javascript.
Нагрузка проводилась в четыре этапа:
* 1 минута в 10 потоков
* 2 минуты в 10 потоков
* 30 секунд в 35 потоков
* 30 секунд в 60 потоков

Сначала нагрузка проводилась локально, на машине разработки.
Характеристики компьютера:
* Intel core i9 10900 (10 cpu)
* 32 ГБ ssd4 3200 MGz

В результате пропускная способность ~ 4500 rps и 95 перцентиль = 6.08

    check_failure_rate.........: 0.00%   ✓ 0       ✗ 1892587
    checks.....................: 100.00% ✓ 1892588 ✗ 0
    data_received..............: 174 MB  414 kB/s
    data_sent..................: 781 MB  1.9 MB/s
    http_req_blocked...........: avg=2.78µs  min=500ns    med=1.8µs  max=10.89ms p(90)=2.5µs  p(95)=3.3µs
    http_req_connecting........: avg=80ns    min=0s       med=0s     max=10.79ms p(90)=0s     p(95)=0s
    http_req_duration..........: avg=2.76ms  min=524.9µs  med=1.69ms max=8.99s   p(90)=3.69ms p(95)=5.84ms
    http_req_receiving.........: avg=28.23µs min=-635µs   med=16.5µs max=17.14ms p(90)=44.6µs p(95)=63.7µs
    http_req_sending...........: avg=18.47µs min=-200.6µs med=11.5µs max=16.41ms p(90)=33.7µs p(95)=48.1µs
    http_req_tls_handshaking...: avg=0s      min=0s       med=0s     max=0s      p(90)=0s     p(95)=0s
    http_req_waiting...........: avg=2.72ms  min=499.6µs  med=1.65ms max=8.99s   p(90)=3.64ms p(95)=5.78ms
    http_reqs..................: 1892588 4505.856282/s
    iteration_duration.........: ***avg=2.98ms  min=643.7µs  med=1.85ms max=8.99s   p(90)=3.93ms p(95)=6.08ms***
    iterations.................: 1892450 4505.527733/s
    vus........................: 59      min=10    max=59
    vus_max....................: 60      min=60    max=60

После публикации приложения на GKE приложение выдержало нагрузку со следующими результатами:


    check_failure_rate.........: 0.00%   ✓ 0     ✗ 24228
    checks.....................: 100.00% ✓ 24229 ✗ 0
    data_received..............: 2.2 MB  18 kB/s
    data_sent..................: 9.7 MB  80 kB/s
    http_req_blocked...........: avg=304.57µs min=800ns    med=1.4µs    max=156.79ms p(90)=2.2µs    p(95)=2.6µs
    http_req_connecting........: avg=302.61µs min=0s       med=0s       max=156.72ms p(90)=0s       p(95)=0s
    http_req_duration..........: avg=145.8ms  min=141.12ms med=145.21ms max=192.6ms  p(90)=148.17ms p(95)=151.83ms
    http_req_receiving.........: avg=32.45µs  min=6.9µs    med=29.9µs   max=441.2µs  p(90)=50.3µs   p(95)=60µs
    http_req_sending...........: avg=17.72µs  min=5.7µs    med=12.1µs   max=909.1µs  p(90)=30.9µs   p(95)=37.25µs
    http_req_tls_handshaking...: avg=0s       min=0s       med=0s       max=0s       p(90)=0s       p(95)=0s
    http_req_waiting...........: avg=145.75ms min=141.08ms med=145.16ms max=192.15ms p(90)=148.11ms p(95)=151.78ms
    http_reqs..................: 24229   201.092835/s
    iteration_duration.........: avg=146.23ms min=141.24ms med=145.34ms max=339.99ms p(90)=148.33ms p(95)=152.15ms
    iterations.................: 24228   201.084535/s
    vus........................: 49      min=10  max=49
    vus_max....................: 50      min=50  max=50

Во втором случае нагрузка проводилась в один этап, 2 минуты в 50 потоков, поскольку нагрузка на GKE стоит денег.

Мощность сервера:
* 4 CPU
* 4 GiB

В результате пропускная способность ~ 200 rps и 95 перцентиль < 153 ms

К сожалению, в текущей реализации и настройки кластера, невозможно масштабировать приложение, так как нужно настроить направление трафика на ноду, к которой клиент подключился изначально.

Важно учитывать, что нагрузки проводилась всегда с одной машины. В идеале нужно проводить нагрузку из разных географических точек.

Примечательно, что всё состояние приложения сейчас хранится в памяти.

Второе замечание, что на момент проведения нагрузки к серверу был подключен пользователь. Соответственно, signalr отсылал все сообщения клиенту.
К сожалению, клиентское приложение не справлятся с такой скоростью, и браузер завис минут на 5, пытаясь отобразить поток сообщений, генерируемых нагрузкой.